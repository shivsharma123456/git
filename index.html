<html>
  <body>
    <form onsubmit="saveToLocalStorage(event)">
      <label>Name:</label>
      <input type="text" name="username" required />

      <label>Email:</label>
      <input type="email" name="emailId" required />

      <label>Phone Number:</label>
      <input type="tel" name="phonenumber" />

      <button type="submit">Submit</button>
    </form>

    <ul id="user-details"></ul>

    <script>
      function saveToLocalStorage(event) {
        event.preventDefault();
        const name = event.target.username.value;
        const email = event.target.emailId.value;
        const phonenumber = event.target.phonenumber.value;

        localStorage.setItem('name', name);
        localStorage.setItem('email', email);
        localStorage.setItem('phonenumber', phonenumber);

        const userDetails = {
          name: name,
          email: email,
          phonenumber: phonenumber,
        };

        localStorage.setItem(email, JSON.stringify(userDetails));
        showUserOnScreen(userDetails);
      }

      function showUserOnScreen(userDetails) {
        const parentElem = document.getElementById('user-details');

        const childElem = document.createElement('li');

        childElem.textContent = userDetails.name + ' (' + userDetails.email  + ')' +  " " + userDetails.phonenumber;

        const editButton = document.createElement('input');
        editButton.type = 'button';
        editButton.value = 'Edit';
        editButton.onclick = () => {
          editUserDetails(userDetails);
        };

        const deleteButton = document.createElement('input');
        deleteButton.type = 'button';
        deleteButton.value = 'Delete';
        deleteButton.onclick = () => {
          localStorage.removeItem(userDetails.email);
          parentElem.removeChild(childElem);
        };

        childElem.appendChild(editButton);
        childElem.appendChild(deleteButton);
        parentElem.appendChild(childElem);
      }

      function editUserDetails(userDetails) {
        const nameInput = prompt('Enter your name', userDetails.name);
        const emailInput = prompt('Enter your email', userDetails.email);
        const phoneInput = prompt('Enter your phone number', userDetails.phonenumber);

        const updatedUserDetails = {
          name: nameInput,
          email: emailInput,
          phonenumber: phoneInput,
        };

        localStorage.setItem(emailInput, JSON.stringify(updatedUserDetails));

        const parentElem = document.getElementById('user-details');
        const childElem = document.createElement('li');
        childElem.textContent = updatedUserDetails.name + ' (' + updatedUserDetails.email  + ')' +  " " + updatedUserDetails.phonenumber;

        const editButton = document.createElement('input');
        editButton.type = 'button';
        editButton.value = 'Edit';
        editButton.onclick = () => {
          editUserDetails(updatedUserDetails);
        };

        const deleteButton = document.createElement('input');
        deleteButton.type = 'button';
        deleteButton.value = 'Delete';
        deleteButton.onclick = () => {
          localStorage.removeItem(updatedUserDetails.email);
          parentElem.removeChild(childElem);
        };

        childElem.appendChild(editButton);
        childElem.appendChild(deleteButton);
        parentElem.replaceChild(childElem, childElem);
      }
      
      for (let i = 0; i < localStorage.length; i++) {
        const key = localStorage.key(i);
        if (key !== 'name' && key !== 'email' && key !== 'phonenumber') {
          const userDetails = JSON.parse(localStorage.getItem(key));
          showUserOnScreen(userDetails);
        }
      }
    </script>
    error
  </body>
</html>
